---
title: '[C#] INI 파일 대신에 XML 로 설정값 저장/유지 하기'
author: 'ash84'
pub_date: '2015-07-03'
description: 'INI 파일이나, 일반적인 파일로 프로그램의 설정값을 유지및 관리 해 오는 일은 예전부터 많았다. 하지만, 필자가 느끼기엔 여간 불편한일이 아니였다. 그래서 여러 검색창을 돌아다디던중 XML과 Hashtable을 가지고 설정을 관리하는 방법을 알아냈다. 특히, 필자의 경우 시리얼 통신을 통해서 여타의 의료기기간의 인터페이스 연결을 해야하는 경우가'
featured_image: ''
tags: ['An Seong Hyun', 'c#', 'dev', 'Hashtable', 'INI', 'System.Collections', 'XML', '안성현', '프로그래밍', '해쉬테이블', '환경설정']
---


<div style="line-height: 2; ">  
<span style="font-size: 11pt; "><span style="font-family: Dotum; ">  
 INI 파일이나, 일반적인 파일로 프로그램의 설정값을 유지및 관리 해 오는 일은 예전부터 많았다. 하지만, 필자가 느끼기엔 여간 불편한일이 아니였다. 그래서 여러 검색창을 돌아다디던중 XML과 Hashtable을 가지고 설정을 관리하는 방법을 알아냈다. 특히, 필자의 경우 시리얼 통신을 통해서 여타의 의료기기간의 인터페이스 연결을 해야하는 경우가 많기 때문에, COM Port에 대한 설정값 저장이 늘 골치거리 였다. </span></span>  
<span class="Apple-style-span" style="font-family: Dotum; font-size: 15px; line-height: 29px; ">  
</span></div><div style="line-height: 2; "><span class="Apple-style-span" style="font-family: Dotum; font-size: 15px; line-height: 29px; ">XML과 Hashtable에 대한 함수.  <div><div style="BORDER-LEFT: #000000 200px solid; PADDING-BOTTOM: 3px; BACKGROUND-COLOR: #e8e8e8; PADDING-LEFT: 6px; WIDTH: 690px; PADDING-RIGHT: 6px; FONT: bold 1pt/1 나눔고딕, Sans-serif; MARGIN-BOTTOM: 10px; HEIGHT: 1px; COLOR: #fff; PADDING-TOP: 3px"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 10pt"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 10pt"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Batang"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 1pt"></span></span></span></span></span></span></span></span></div><div style="LINE-HEIGHT: 1.7"><span style="FONT-FAMILY: Dotum"><font color="#474747">﻿</font><span style="FONT-SIZE: 10pt"><font color="#474747">﻿</font><span style="FONT-FAMILY: Dotum"><font color="#474747">﻿</font><span style="FONT-SIZE: 10pt"><font color="#474747">﻿ </font></span></span></span></span></div></div></span></div><div></div><div><div>  </div><div></div><div class="txc-textbox" style="BORDER-RIGHT: rgb(121,165,228) 1px solid; PADDING-RIGHT: 10px; BORDER-TOP: rgb(121,165,228) 1px solid; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; BORDER-LEFT: rgb(121,165,228) 1px solid; PADDING-TOP: 10px; BORDER-BOTTOM: rgb(121,165,228) 1px solid; BACKGROUND-COLOR: rgb(219,232,251)"><div></div><div>         /// <summary></div><div>         ///해쉬테이블을 읽어서 xml파일에 저장한다.</div><div>         /// </summary></div><div>         /// <param name=”ht”></param></div><div>         /// <returns></returns></div><div></div><div>         public int WriteXml(Hashtable ht)</div><div>         {</div><div>             IDictionaryEnumerator htEnum = ht.GetEnumerator();</div><div></div><div>             XmlTextWriter tw = tw = new XmlTextWriter(Application.StartupPath + @”\ini.xml”, Encoding.UTF8);</div><div></div><div>             tw.Formatting = Formatting.Indented;</div><div></div><div>             tw.WriteStartDocument();</div><div></div><div>             tw.WriteStartElement(“Configuration”);</div><div></div><div>             while (htEnum.MoveNext())</div><div>             {</div><div>                 tw.WriteElementString(htEnum.Key.ToString(), htEnum.Value.ToString());</div><div>             }</div><div></div><div>             tw.WriteEndElement();</div><div>             tw.WriteEndDocument();</div><div></div><div>             tw.Flush();</div><div>             tw.Close();</div><div>             return 0;</div><div></div><div>         }</div></div><div></div><div></div><div></div><div></div><div></div><div class="txc-textbox" style="BORDER-RIGHT: rgb(121,165,228) 1px solid; PADDING-RIGHT: 10px; BORDER-TOP: rgb(121,165,228) 1px solid; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; BORDER-LEFT: rgb(121,165,228) 1px solid; PADDING-TOP: 10px; BORDER-BOTTOM: rgb(121,165,228) 1px solid; BACKGROUND-COLOR: rgb(219,232,251)"><div></div><div>         /// <summary></div><div>         /// xml파일을 읽어서 해쉬테이블에 저장한다.</div><div>         /// </summary></div><div>         /// <returns></returns></div><div></div><div>         public Hashtable ReadXml()</div><div>         {</div><div></div><div>             try</div><div>             {</div><div></div><div>                 string sKey, sValue;</div><div>                 Hashtable ht = new Hashtable();</div><div>                 XmlTextReader xtr = new XmlTextReader(Application.StartupPath + @”\ini.xml”);</div><div></div><div>                 while (xtr.Read())</div><div>                 {</div><div></div><div>                     if (xtr.NodeType == XmlNodeType.Element)</div><div>                     {</div><div></div><div>                         sKey = xtr.LocalName;</div><div></div><div>                         xtr.Read();</div><div></div><div>                         if (xtr.NodeType == XmlNodeType.Text)</div><div>                         {</div><div>                             sValue = xtr.Value;</div><div></div><div>                             ht.Add(sKey, sValue);</div><div>                         }</div><div></div><div>                         else</div><div>                             continue;</div><div></div><div>                     }</div><div></div><div>                 }//while</div><div></div><div>                 xtr.Close();</div><div>                 return ht;</div><div></div><div>             }</div><div>             catch (FileNotFoundException e)</div><div>             {</div><div></div><div>                 //xml파일을 찾지 못할경우 default값이 들어있는 해쉬테이블을 리턴한다.</div><div>                 Hashtable ht = new Hashtable();</div><div></div><div>                 ht.Add(“txtInputWidth”, “287”);</div><div>                 ht.Add(“formHeight”, “400”);</div><div>                 ht.Add(“txtContentHeight”, “296”);</div><div>                 ht.Add(“formWidth”, “363”);</div><div>                 ht.Add(“formTop”, “122”);</div><div>                 ht.Add(“formLeft”, “214”);</div><div>                 ht.Add(“txtInputTop”, “300”);</div><div></div><div>                 return ht;</div><div></div><div>             }</div><div></div><div>         }</div><div></div></div><div></div><div></div><div><span style="font-size: 11pt; "><span style="font-family: Dotum; ">**호출해서 사용하는 부분 **</span></span></div><div><div><div style="BORDER-LEFT: #000000 200px solid; PADDING-BOTTOM: 3px; BACKGROUND-COLOR: #e8e8e8; PADDING-LEFT: 6px; WIDTH: 690px; PADDING-RIGHT: 6px; FONT: bold 1pt/1 나눔고딕, Sans-serif; MARGIN-BOTTOM: 10px; HEIGHT: 1px; COLOR: #fff; PADDING-TOP: 3px"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 10pt"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 10pt"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Batang"><span style="FONT-SIZE: 11pt"><span style="FONT-SIZE: 1pt"></span></span></span></span></span></span></span></span></div><div style="LINE-HEIGHT: 1.7"><span style="FONT-FAMILY: Dotum"><font color="#474747">﻿</font><span style="FONT-SIZE: 10pt"><font color="#474747">﻿</font><span style="FONT-FAMILY: Dotum"><font color="#474747">﻿</font><span style="FONT-SIZE: 10pt"><font color="#474747">﻿ </font></span></span></span></span></div></div></div><div></div><div class="txc-textbox" style="BORDER-RIGHT: rgb(159,211,49) 1px solid; PADDING-RIGHT: 10px; BORDER-TOP: rgb(159,211,49) 1px solid; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; BORDER-LEFT: rgb(159,211,49) 1px solid; PADDING-TOP: 10px; BORDER-BOTTOM: rgb(159,211,49) 1px solid; BACKGROUND-COLOR: rgb(231,253,181)"><div>            <span class="Apple-style-span" style="COLOR: rgb(49,133,97)"><span class="Apple-style-span" style="FONT-WEIGHT: bold">Hashtable ht = new Hashtable();</span></span></div><div></div><div><div>             ht.Add(“portnum”, combo_portNum.Text);</div><div>             ht.Add(“bitpersec”, combo_bitpersec.Text);</div><div>             ht.Add(“databit”, combo_databit.Text);</div><div>             ht.Add(“paritybit”, combo_paritybit.Text);</div><div>             ht.Add(“stopbit”, combo_stopbit.Text);</div><div></div><div>             Making_ConfXmlFile xf = new Making_ConfXmlFile();</div><div></div><div></div><div>             if (xf.WriteXml(ht) == 0)</div><div>             {</div><div>                 MessageBox.Show(“저장되었습니다.”);</div><div>             }</div><div>             else</div><div>             {</div><div>                 MessageBox.Show(“저장하지 못했습니다.”);</div><div>              }</div><div></div></div></div><div><div></div></div><div></div><div></div><div>     </div></div>

