<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO -->
    <title>Windows Service - ASH84</title>
    <meta name="description" content="Windows Service" />
    <meta name="author" content="ASH84" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://ash84.io/2007/10/05/windows-service/" />

    <!-- Open Graph -->
    <meta property="og:site_name" content="ASH84"/>
    <meta property="og:title" content="Windows Service"/>
    <meta property="og:description" content="Windows Service"/>
    <meta property="og:url" content="https://ash84.io/2007/10/05/windows-service/"/>
    <meta property="og:locale" content="ko_KR"/>
    <meta property="og:type" content="article"/>
    <meta property="article:published_time" content="" />
    <meta property="article:author" content="https://ash84.io/" />
    
    <meta property="article:tag" content="C#" />
    
    <meta property="article:tag" content="dev" />
    
    <meta property="article:tag" content="Installtutil" />
    
    <meta property="article:tag" content="System.ComponentModel" />
    
    <meta property="article:tag" content="System.Configuration.Install" />
    
    <meta property="article:tag" content="System.ServiceProcess" />
    
    <meta property="article:tag" content="Windows Service" />
    
    <meta property="article:tag" content="서비스등록" />
    
    
    <meta property="og:image" content="https://ash84.io/assets/og-image.png"/>
    
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@sh84ahn"/>
    <meta name="twitter:creator" content="@sh84ahn"/>
    <meta name="twitter:title" content="Windows Service"/>
    <meta name="twitter:description" content="Windows Service"/>
    
    <meta name="twitter:image" content="https://ash84.io/assets/og-image.png"/>
    

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "Windows Service",
        "description": "Windows Service",
        "author": {
            "@type": "Person",
            "name": "",
            "url": "https://ash84.io"
        },
        "datePublished": "",
        "dateModified": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://ash84.io/2007/10/05/windows-service"
        },
        
        "publisher": {
            "@type": "Organization",
            "name": "ASH84"
        }
    }
    </script>

    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71946262-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-71946262-1');
    </script>

    <!-- Fonts & Styles -->
    <link rel="stylesheet" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.5/dist/web/static/pretendard.css" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>◼</text></svg>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/styles/github.min.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/post.css"/>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
    <header class="post-header">
        <nav class="nav">
            <a href="/" class="nav-home">← ASH84</a>
        </nav>
    </header>

    <article class="post">
        <header class="post-meta">
            <time class="post-date">2007-10-05</time>
            <h1 class="post-title">Windows Service</h1>
            
            <div class="post-tags">
                
                <a href="/tags/C#/" class="tag">C#</a>
                
                <a href="/tags/dev/" class="tag">dev</a>
                
                <a href="/tags/Installtutil/" class="tag">Installtutil</a>
                
                <a href="/tags/System.ComponentModel/" class="tag">System.ComponentModel</a>
                
                <a href="/tags/System.Configuration.Install/" class="tag">System.Configuration.Install</a>
                
                <a href="/tags/System.ServiceProcess/" class="tag">System.ServiceProcess</a>
                
                <a href="/tags/Windows Service/" class="tag">Windows Service</a>
                
                <a href="/tags/서비스등록/" class="tag">서비스등록</a>
                
            </div>
            
        </header>

        

        <div class="post-content">
            <p>Windows Service  ![사용자 삽입 이미지](http://ash84.net/wp-content/uploads/1/el123.JPG) </p>
<p>**Windows Service 란?** – 여러 응용프로그램을 백그라운드 프로세스로 운영하는 것 – exe, dll이 아니라 os가 내부적으로 실행 – 구성요소의 서비스 목록에 나열되어 있음</p>
<h2>**Windows Service ****응용프로그램 개발** – Main( ), OnStart( ), OnStop( ) 이 필요  – 참조추가 :**System.Service Process** ** ** ** ** **1. ****Service ****파일 : 서비스 동작을 하는 파일, ServiceBase 클래스를 확장한다. ** public static void Main() { System.ServiceProcess.ServiceBase[] ServiceToRun; ServiceToRun = new ServiceBase[] { new Service() }; System.ServiceProcess.ServiceBase.Run(ServiceToRun); } ServiceBase class의 배열 인스턴스를 생성해서 현재 서비스 클래스를 추가한다.  (현재 ServiceBase class를 확장한 클래스를 추가하는 것) **2. ****Override Member ****추가** Protected형 멤버를 추가</h2>
<h2>– protected override void OnStart(string[] args) – protected override void OnStop()  &lt; 기본적으로 사용가능&gt;</h2>
<h2>– protected override void OnPause() – protected override void OnContinue() 속성(True)&gt;</h2>
<p>** protected override void OnStop()**  { FileStream fs = new FileStream(@”c:\log_stop.txt”, FileMode.OpenOrCreate, FileAccess.Write); StreamWriter sr = new StreamWriter(fs); sr.WriteLine(“MYWindowsService stopped”); sr.Flush(); sr.Close(); } ** protected override void OnPause()**  { FileStream fs = new FileStream(@”c:\log_stop.txt”, FileMode.OpenOrCreate, FileAccess.Write); StreamWriter sr = new StreamWriter(fs); sr.WriteLine(“잠시중지“); sr.Flush(); sr.Close(); }</p>
<p>*** Windows Service Event – 서비스의 상태에 따라 달라진다. ** ** ** Start : OnStart( ), ServiceStarmode(Automatic, manual, Disabled) : 어떤식으로 시작하는지 Stop : OnStop( ) Pause : OnPause( ) , 시스템의 리소스를 따로 보유할 수 있다.  Continue : OnContinue( ), OnPause와의 반대 기능을 실행할수 있다. </p>
<p>**3. ****ServiceInstaller, ServiceProcessInstaller ****세팅** – Service를 수행하는 클래스 외에 Installer 기능을 하는 하나의 클래스를 별로도  추가한다.  **using System.ComponentModel;** **using System.ServiceProcess;** **using System.Configuration.Install;**  namespace MyWindowsService { ** <em>[RunInstallerAttribute(true)]</em> ** ** //****어셈블리가 설치될 때 Visual Studio 사용자 지정 동작 설치 관리자 또는 [설치관리자도구(Installutil.exe)](http://msdn2.microsoft.com/ko-kr/library/50614e95(VS.80).aspx)의 호출 여부를 지정합니다.** ** ** ** **  public class ServiceInstallers **: Installer** { ** private ServiceInstaller serviceInstaller;** ** // ****서비스응용프로그램을설치하는인스톨러** ** private ServiceProcessInstaller serviceProcessInstaller;** ** // ****서비스를운용하는프로세스를등록하는인스톨러** public ServiceInstallers() { //생성자 this.serviceProcessInstaller = new ServiceProcessInstaller(); ** this.serviceProcessInstaller.Account = ServiceAccount.LocalSystem;** ** **  //this.serviceProcessInstaller.Account = ServiceAccount.User; //this.serviceProcessInstaller.Username = “Administrator”; //this.serviceProcessInstaller.Password = “6750”; // 계정과패스워드를정확히입력해야한다.  this.serviceInstaller = new ServiceInstaller(); **this.serviceInstaller.ServiceName = “Service”;** ** // ****시스템에서서비스이름으로식별한다. ** ** // ****서비스이름은ServiceBase 를확장한클래스명이다. ** **Installers.Add(serviceInstaller);** ** Installers.Add(serviceProcessInstaller);** ** **  } } } **4. ****cmd****에서 Installtutil을 이용해서 윈도우 서비스 등록 ** ![사용자 삽입 이미지](http://ash84.net/wp-content/uploads/1/gl123.JPG) Installutill  /i MyWindowsService.exe : 서비스 등록 Installutill  /u MyWindowsService.exe : 서비스 해제</p>
        </div>
    </article>

    <footer class="post-footer">
        <div class="footer-content">
            <p class="footer-author">Written by <a href="/">ASH84</a></p>
            <p class="footer-copyright">&copy; <script>document.write(new Date().getFullYear())</script></p>
        </div>
    </footer>

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8699046198561974" crossorigin="anonymous"></script>
</body>
</html>