<!DOCTYPE html>
<html lang="ko">
<head>
    <script src="https://unpkg.com/tachyonjs@1.1.1/tachyon.min.js" integrity="sha384-eAVplf5NYzHCSEB5NSZ5vabWAMYIb9Y2E4SKcU78UTIjukDs0tMxFQX0FLmBVYi8" type="module" crossorigin defer></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71946262-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-71946262-1');
    </script>
    
    <!-- google adsense -->
    <script data-ad-client="ca-pub-8699046198561974" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
    
    </script>
    <!-- //google adsense -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta property="og:site_name" content="ASH84"/>
    <meta property="og:title" content="ASH84 - SQLAlchemy autocommit ì— ëŒ€í•´ì„œ "/>
    <meta property="og:description" content="DB ìƒì—ì„œ autocommit ì´ë€ ë°ì´í„° ë³€ê²½ ì‘ì—…ì— ëŒ€í•œ SQL ìì²´ê°€ ë°”ë¡œ ë°˜ì˜ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë°   autocommit ì´ ì•„ë‹Œ ìƒíƒœì—ì„œëŠ” ì—¬ëŸ¬ì¤„ì˜ ëª…ë ¹ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì„ìˆ˜ê°€ ìˆë‹¤.(ê°œë³„ DBMS ì—”ì§„ì´ë‚˜ DBíƒ€ì…ì— ë”°ë¼ ë‹¤ë¥¼ìˆ˜ëŠ” ìˆë‹¤. ì—¬ê¸°ì—ì„œëŠ” MYSQL InnoDB ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.)"/>
    <meta property="og:url" content="https://ash84.io/docs/2018/07/30/sqlalchemy-autocommit"/>
    <meta property="og:image" content="https://ash84.io/docs/2018/07/30/sqlalchemy-autocommit/"/> 
    <meta property="og:type" content="article"/>
    <meta name="google-site-verification" content="i4L_oOQ7MwcZ9qx23WLpI0MqOuGOzm5mG5cP20fRrUQ" />
    <title>SQLAlchemy autocommit ì— ëŒ€í•´ì„œ </title>
    <meta name="description" content="DB ìƒì—ì„œ autocommit ì´ë€ ë°ì´í„° ë³€ê²½ ì‘ì—…ì— ëŒ€í•œ SQL ìì²´ê°€ ë°”ë¡œ ë°˜ì˜ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë°   autocommit ì´ ì•„ë‹Œ ìƒíƒœì—ì„œëŠ” ì—¬ëŸ¬ì¤„ì˜ ëª…ë ¹ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì„ìˆ˜ê°€ ìˆë‹¤.(ê°œë³„ DBMS ì—”ì§„ì´ë‚˜ DBíƒ€ì…ì— ë”°ë¼ ë‹¤ë¥¼ìˆ˜ëŠ” ìˆë‹¤. ì—¬ê¸°ì—ì„œëŠ” MYSQL InnoDB ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.)" />
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.5/dist/web/static/pretendard.css" />
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ³</text></svg>">
    <!--  code highlight -->
    <link rel="stylesheet"
          href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/styles/default.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/highlight.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/../../assets/css/github-dark.css"/>
    <link rel="stylesheet" type="text/css" href="/../../assets/css/post.css"/>
    <script>hljs.highlightAll();</script>
     
</head>
<body class="font"> 
    <header>
        <div class="blog-post-back">
            <a href="/">
                <svg fill="#000000" height="35px" width="35px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 219.151 219.151" xml:space="preserve">
    <g>
        <path d="M109.576,219.151c60.419,0,109.573-49.156,109.573-109.576C219.149,49.156,169.995,0,109.576,0S0.002,49.156,0.002,109.575
            C0.002,169.995,49.157,219.151,109.576,219.151z M109.576,15c52.148,0,94.573,42.426,94.574,94.575
            c0,52.149-42.425,94.575-94.574,94.576c-52.148-0.001-94.573-42.427-94.573-94.577C15.003,57.427,57.428,15,109.576,15z"/>
        <path d="M94.861,156.507c2.929,2.928,7.678,2.927,10.606,0c2.93-2.93,2.93-7.678-0.001-10.608l-28.82-28.819l83.457-0.008
            c4.142-0.001,7.499-3.358,7.499-7.502c-0.001-4.142-3.358-7.498-7.5-7.498l-83.46,0.008l28.827-28.825
            c2.929-2.929,2.929-7.679,0-10.607c-1.465-1.464-3.384-2.197-5.304-2.197c-1.919,0-3.838,0.733-5.303,2.196l-41.629,41.628
            c-1.407,1.406-2.197,3.313-2.197,5.303c0.001,1.99,0.791,3.896,2.198,5.305L94.861,156.507z"/>
    </g>
        </svg></a>
        </div>
    </header>
    
<div class="content">
    <h1 class="blog-post-title">SQLAlchemy autocommit ì— ëŒ€í•´ì„œ </h1>
    <div class="blog-post-meta"> 
        <small>  2018-07-30</small> 
    </div> 

    <div class="pre-blog-post"></div>

    
    <div class="blog-post">
        <p>DB ìƒì—ì„œ autocommit ì´ë€ ë°ì´í„° ë³€ê²½ ì‘ì—…ì— ëŒ€í•œ SQL ìì²´ê°€ ë°”ë¡œ ë°˜ì˜ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë°   autocommit ì´ ì•„ë‹Œ ìƒíƒœì—ì„œëŠ” ì—¬ëŸ¬ì¤„ì˜ ëª…ë ¹ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì„ìˆ˜ê°€ ìˆë‹¤.(ê°œë³„ DBMS ì—”ì§„ì´ë‚˜ DBíƒ€ì…ì— ë”°ë¼ ë‹¤ë¥¼ìˆ˜ëŠ” ìˆë‹¤. ì—¬ê¸°ì—ì„œëŠ” MYSQL InnoDB ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.)</p>
<p><strong>mysql autocommit í™•ì¸í•˜ê¸°</strong> </p>
<pre><code class="language-python">SELECT @@AUTOCOMMIT;
</code></pre>
<p><strong>mysql autocommit ì„¤ì •/í•´ì œ í•˜ê¸°</strong> </p>
<pre><code class="language-python">SET AUTOCOMMIT = TRUE;   // AUTOCOMMIT ì„¤ì •
SET AUTOCOMMIT = FALSE;  // AUTOCOMMIT í•´ì œ

COMMIT; // ì»¤ë°‹
ROLLBACK; // ë¡¤ë°±
</code></pre>
<p><strong>í…ŒìŠ¤íŠ¸</strong></p>
<pre><code class="language-python">SET AUTOCOMMIT = FALSE;  
insert into test.tb_category values(9, null, null, 'í…ŒìŠ¤íŠ¸', 0); 
commit;
# commit ì„ í•´ì•¼ ë°˜ì˜ëœ ê²ƒì´ ë³´ì¸ë‹¤. 
</code></pre>
<h2>SQLAlchemy ì˜ autocommit ì„¤ì •</h2>
<p>ì•„ë˜ëŠ” ê¸°ë³¸ì ì¸ SQLAlchemy ì— ë‚˜ì˜¤ëŠ” íŠ¸ëœì­ì…˜ ê´€ë ¨ ì„¤ëª…ì„ (ë°œ)ë²ˆì—­í•œ ë‚´ìš©ì´ë‹¤. </p>
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/core/connections.html#understanding-autocommit">Using Transactions</a></li>
</ul>
<p><code>Connection</code> ê°ì²´ëŠ” <code>begin()</code> ë©”ì†Œë“œë¥¼ ì œê³µí•˜ëŠ”ë° ì´ í•¨ìˆ˜ëŠ” <code>Transaction</code> ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ì´ ê°ì²´ëŠ” try/catch ë¬¸ ì•ˆì—ì„œ ì‚¬ìš©ë˜ê³  (íŠ¸ëœì­ì…˜ì„) ë³´ì¥í•˜ê¸° ìœ„í•´ì„œ <code>Transaction.rollback()</code>, <code>Transaction.commit()</code> ì„ ì‚¬ìš©í•œë‹¤. </p>
<pre><code class="language-python">connection = engine.connect()
trans = connection.begin()
try:
    r1 = connection.execute(table1.select())
    connection.execute(table1.insert(), col1=7, col2='this is some data')
    trans.commit()
except:
    trans.rollback()
    raise
</code></pre>
<p>ìœ„ì˜ ì½”ë“œëŠ” context manager ë¥¼ ì´ìš©í•´ì„œ ì¢€ ë” ê°„ê²°í•˜ê²Œ ë§Œë“¤ìˆ˜ ìˆë‹¤. </p>
<pre><code class="language-python">## runs a transaction
with engine.begin() as connection:
    r1 = connection.execute(table1.select())
    connection.execute(table1.insert(), col1=7, col2='this is some data')

## or 
with connection.begin() as trans:
    r1 = connection.execute(table1.select())
    connection.execute(table1.insert(), col1=7, col2='this is some data')
</code></pre>
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/core/connections.html#nesting-of-transaction-blocks">Nesting of Transaction Blocks</a></li>
</ul>
<p><code>Transaction</code> ê°ì²´ëŠ” ê°€ì¥ ë°”ê¹¥ìª½ begin/commit ì˜ ìŒì„ ì¶”ì í•´ì„œ ì¤‘ì²©(nested)ëœ ë™ì‘ì„ ì²˜ë¦¬í•œë‹¤. ì•„ë˜ì˜ ì½”ë“œì—ì„œ ë³´ë©´ ê°€ì¥ ë°”ê°™ìª½ì˜ method_a() ì— ëŒ€í•œ ì»¤ë°‹ë§Œ ìˆ˜í–‰ëœë‹¤.  </p>
<pre><code class="language-python">## method_a starts a transaction and calls method_b
def method_a(connection):
    trans = connection.begin()  # open a transaction
    try:
        method_b(connection)
        trans.commit()  # transaction is committed here
    except:
        trans.rollback()  # this rolls back the transaction unconditionally
        raise


## method_b also starts a transaction
def method_b(connection):
    trans = connection.begin()  # open a transaction - this runs in the context of method_a's transaction
    try:
        connection.execute(&quot;insert into mytable values ('bat', 'lala')&quot;)
        connection.execute(mytable.insert(), col1='bat', col2='lala')
        trans.commit()  # transaction is not committed yet
    except:
        trans.rollback()  # this rolls back the transaction unconditionally
        raise


## open a Connection and call method_a
conn = engine.connect()
method_a(conn)
conn.close()
</code></pre>
<p>ìœ„ì˜ ì½”ë“œì—ì„œ ì²˜ìŒ í˜¸ì¶œëœ method_a ê°€ <code>connection.begin()</code> ì„ í˜¸ì¶œí•œë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ method_b ë¥¼ í˜¸ì¶œí•œë‹¤. method_b ê°€ <code>connection.begin()</code> ì„ í˜¸ì¶œí•  ë•Œ, ì¹´ìš´ë”ë¥¼ ì¦ê°€ ì‹œí‚¤ê³  <code>commit()</code> ì„ í˜¸ì¶œí•  ë•Œ ì¹´ìš´í„°ë¥¼ ê°ì†Œì‹œí‚¨ë‹¤. ë§Œì•½ method_a, method_b ê°€ <code>rollback()</code> ì„ í˜¸ì¶œí•˜ë©´ ì „ì²´ íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±ëœë‹¤. ì´ íŠ¸ëœì­ì…˜ì€ method_a ì˜ <code>commit()</code> í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ê¸° ì „ê¹Œì§€ ì»¤ë°‹ë˜ì§€ ì•ŠëŠ”ë‹¤. This â€œnestingâ€ behavior allows the creation of functions which â€œguaranteeâ€ that a transaction will be used if one was not already available, but will automatically participate in an enclosing transaction if one exists.</p>
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/core/connections.html#understanding-autocommit">Understanding Autocommit</a></li>
</ul>
<p>INSERT, UPDATE, DELETE ë¥¼ ì‹¤í–‰ ì‹œ Transaction ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚ ê¹Œ? ì–´ë–¤ DBAPI êµ¬í˜„ë“¤ì€ íŠ¹ë³„í•œ "non-transactional" ëª¨ë“œë“¤ì„ ì œê³µí•˜ì§€ë§Œ, PEP-0249 ì˜ DBAPI ì˜ í•µì‹¬ë™ì‘ì€ íŠ¸ëœì­ì…˜ì€ í•­ìƒ ì§„í–‰ì¤‘ì´ë©°, <code>rollback()</code>, <code>commit()</code> í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì§€ë§Œ, <code>begin()</code> ì€ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤. SQLAlchemy ëŠ” ì´ê²ƒì´ ì£¼ì–´ì§„ DBAPIì˜ ê²½ìš°ë¼ê³  ê°€ì •í•œë‹¤. ì£¼ì–´ì§„ ìš”êµ¬ì‚¬í•­ì—ì„œ, SQLAlchemy ëŠ” ëª¨ë“  ë°±ì—”ë“œì—ì„œ ì¼ê´€ë˜ê²Œ ë™ì‘í•˜ëŠ” ìì²´ "autocommit" ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë°ì´í„° ë³€ê²½ ì‘ì—… ëª…ë ¹ ëŒ€í•œ ê°ì§€ë¥¼ ëª©í‘œë¡œ í•œë‹¤. ì˜ˆë¥¼ ë“¤ë©´, INSERT, UPDATE, DELETE  ë¿ë§Œ ì•„ë‹ˆë¼, DDL(CREATE TABLE, ALETER TABLE). ê·¸ë¦¬ê³  íŠ¸ëœì­ì…˜ì´ ì§„í–‰ì¤‘ì´ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ COMMIT ëœë‹¤. ì´ëŸ¬í•œ ëª…ë ¹ì˜ ê°ì§€ëŠ” <code>autocommit=True</code> ì‹¤í–‰ì˜µì…˜ì´ ìˆëŠ”ì§€ì— ê¸°ì´ˆí•œë‹¤. ë§Œì•½ ëª…ë ¹ë¬¸ì— í”Œë˜ê·¸ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, ì •ê·œí‘œí˜„ì‹ì´ INSERT, UPDATE, DELETE ë¿ë§Œ ì•„ë‹ˆë¼ íŠ¹ì •í•œ ë°±ì—”ë“œì˜ ë‹¤ì–‘í•œ ëª…ë ¹ì„ ê°ì§€í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. </p>
<pre><code class="language-python">conn = engine.connect()
conn.execute(&quot;INSERT INTO users VALUES (1, 'john')&quot;)  # autocommits
</code></pre>
<p>autocomit ê¸°ëŠ¥ì€ <code>Transaction</code> ì´ ì„ ì–¸ë˜ì§€ ì•Šì•˜ì„ë•Œë§Œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ <code>Session</code> ê°ì²´ëŠ” í•­ìƒ ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì„ ìœ ì§€ê´€ë¦¬í•˜ê¸°ë•Œë¬¸ì— ì´ ê¸°ëŠ¥ì€ ì¼ë°˜ì ìœ¼ë¡œ ORM ê³¼ í•¨ê»˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. </p>
<p>autocommit ë™ì‘ì˜ ì „ì²´ ì œì–´ëŠ” <code>Connection</code>, <code>Engine</code>, Executable ì´ ì œê³µí•˜ëŠ”<code>Connection.execution_options()</code> í•¨ìˆ˜ì— autocommit í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì„ íƒëœ ë²”ìœ„ë‚´ì— ëŒ€í•´ì„œ ë„ê³  ì¼œëŠ”ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. </p>
<pre><code class="language-python">engine.execute(text(&quot;SELECT my_mutating_procedure()&quot;).execution_options(autocommit=True))
</code></pre>
<hr />
<p>ìœ„ì˜ SQLAlchemy ì—ì„œ ì œê³µí•˜ëŠ” ë¬¸ì„œë“¤ì˜ ì¼ë¶€ë¶„ì„ ì½ì–´ë³´ë©´ SQLAlchemy ì˜ autommit ì˜µì…˜ì€ ëª¨ë“  ë°±ì—”ë“œì— ì¼ê´€ë˜ê²Œ ë™ì‘ì‹œí‚¤ê¸° ìœ„í•´ì„œ ë§Œë“¤ì–´ ì¡Œë‹¤ê³  í•œë‹¤. ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ autocommit ì˜µì…˜ì„¤ì • ì—¬ë¶€ì™€ begin(), commit() í˜¸ì¶œì—¬ë¶€ë¥¼ ê°€ì§€ê³  ë°ì´í„° insert ë¥¼ í…ŒìŠ¤íŠ¸ í•´ë³´ì•˜ë‹¤. </p>
<p><strong>sqlalchemy autocommit on + ëª…ì‹œì  commit() í˜¸ì¶œ = ë°ì´í„° insert</strong></p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=True)
session = Session()

session.begin()
test = Test(text=&quot;text_{}&quot;.format(datetime.now()))
session.add(test)
session.commit() 
session.close()
</code></pre>
<p><strong>sqlalchemy autocommit on + ëª…ì‹œì  commit() í˜¸ì¶œì•ˆí•¨ = ë°ì´í„° NOT insert</strong> </p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=True)
session = Session() 
test = Test(text=&quot;text_{}&quot;.format(datetime.now()))
session.add(test) 
session.close()
</code></pre>
<p>ì´ìƒí•˜ë‹¤. ìë™ì»¤ë°‹ì€ ë§ ê·¸ëŒ€ë¡œ <code>session.commit()</code> ì„ í•˜ì§€ ì•Šì•„ë„ insert ë¬¸ì— ëŒ€í•´ì„œ DBë°˜ì˜ì´ ë˜ì–´ì•¼ í•˜ëŠ”ê²Œ ì•„ë‹Œê°€?</p>
<p>ì¢€ ë” í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì. </p>
<p><strong>sqlalchemy autocommit off + ëª…ì‹œì  begin(), commit() í˜¸ì¶œ = ì—ëŸ¬ë°œìƒ</strong></p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=False)
session = Session() 
test = Test(text=&quot;text_{}&quot;.format(datetime.now()))
session.begin()
session.add(test) 
session.commit()
session.close()
</code></pre>
<pre><code>InvalidRequestError: A transaction is already begun. Use subtransactions=True to allow subtransactions.
</code></pre>
<p>ë„ë°ì²´ ì´ ì—ëŸ¬ëŠ” ëª°ê¹Œ? ìë™ì»¤ë°‹ ëª¨ë“œë¥¼ ê»ìœ¼ë©´, ìë™ìœ¼ë¡œ ì»¤ë°‹ì´ ì•ˆë˜ê³  ëª…ì‹œì  <code>begin()</code>, <code>commit()</code> ì„ í˜¸ì¶œí–ˆìœ¼ë‹ˆ ë˜ì–´ì•¼ í•˜ëŠ”ê²Œ ì•„ë‹Œê°€? ì™œ ì—ëŸ¬ê°€ ë‚ ê¹Œ? </p>
<p><strong>sqlalchemy autocommit off + ëª…ì‹œì  commit() í˜¸ì¶œì•ˆí•¨ = ë°ì´í„° NOT insert</strong> </p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=False)
session = Session() 
test = Test(text=&quot;text_{}&quot;.format(datetime.now()))
session.add(test) 
session.close()
</code></pre>
<p>ë­”ê°€ ì´ìƒí•˜ë‹¤. ë‚´ê°€ ì•Œê³ ìˆëŠ”. ë§ ê·¸ëŒ€ë¡œ ìë™ì»¤ë°‹ì´ ì•„ë‹ˆë˜ê°€? ì¢€ ë” autocommit ê´€ë ¨ ë¬¸ì„œë¥¼ ì½ì–´ë³´ì. </p>
<hr />
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/orm/session_transaction.html#transactions-and-connection-management">Transactions and Connection Management</a></li>
<li><a href="http://docs.sqlalchemy.org/en/latest/orm/session_transaction.html#managing-transactions">Managing Transactions</a></li>
</ul>
<p><strong>ìƒˆë¡­ê²Œ ìƒì„±ëœ <code>Session</code> ì€ "begin" ìƒíƒœë¥¼ ê°€ì§„ë‹¤.</strong> ì´ ìƒíƒœì—ì„œ <code>Sesssion</code> ì€  <code>Engine</code> ê³¼ì–´ë–¤ ì—°ê²°ì´ë‚˜ íŠ¸ëœì­ì…˜ì„ ë§ºì§€ ì•ŠëŠ”ë‹¤. <code>Session</code> ê·¸ë¦¬ê³ ë‚˜ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì‹œ ë™ì‘í•  ìš”ì²­ì„ ë°›ëŠ”ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ  <code>Session.query()</code>, <code>Session.execute()</code> ë˜ëŠ” ë³´ë¥˜ì¤‘ì¸ ë°ì´í„°ì˜ flush ë™ì‘ì„ í†µí•´ì„œ SQLë¬¸ì´ ì‹¤í–‰ë˜ê³  Session.commit(), Session.flush() ê°€ í˜¸ì¶œëœë‹¤. </p>
<p>ì´ëŸ¬í•œ ìš”ì²­ì´ ì™”ì„ ë•Œ, ê°ê°ì˜ ìƒˆë¡œìš´ <code>Engine</code> ì€ <code>Sesssion</code> ì— ì˜í•´ ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ ìƒíƒœì™€ ì—°ê´€ì´ ìˆë‹¤. ì²«ë²ˆì§¸ <code>Engine</code> ì´ ìˆ˜í–‰ë ë•Œ, <code>Session</code> "begin" ìƒíƒœì—ì„œ "transactional" ìƒíƒœë¡œ ì§„ì…í•˜ê²Œ ëœë‹¤. ê°ê°ì˜ <code>Engine</code> ì´ <code>Connection</code> ê³¼ ì—°ê²°ë˜ì–´ ìˆìœ¼ë©° <code>Engine.contextual_connect()</code> ë¥¼ í†µí•´ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ë§Œì•½ <code>Connection</code> ì´ ì§ì ‘ì ìœ¼ë¡œ <code>Session</code> ê³¼ ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´ (Sessionì´)ì§ì ‘ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ìƒíƒœë¥¼ ì¶”ê°€í•˜ê²Œ ëœë‹¤(?) </p>
<p>ê°ê°ì˜ <code>Connection</code> ì— ëŒ€í•´ì„œ <code>Session</code> ì€ ë˜í•œ <code>Transaction</code> ê°ì²´ë¥¼ ìœ ì§€í•˜ëŠ”ë° ì´ ê°ì²´ëŠ” <code>Connection</code> ìƒì—ì„œ <code>Connection.begin()</code> ì„ í˜¸ì¶œí•¨ìœ¼ë¡œì¨ ê°€ì ¸ì˜¬ìˆ˜ ìˆê±°ë‚˜ í˜¹ì€ <code>Session</code> ê°ì²´(<code>twophase=True</code> flag ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê²°ëœ) ë¥¼ í†µí•´ì„œ ì–»ì„ìˆ˜ ìˆë‹¤. <code>TwoPhaseTransaction</code> ê°ì²´ëŠ” <code>Connection.begin_twophase()</code> ì„ í†µí•´ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ íŠ¸ëœì­ì…˜ë“¤ì€ <code>Session.commit()</code> ê³¼ <code>Session.rollback()</code> ì˜ í˜¸ì¶œì— ì˜í•´ì„œ ì»¤ë°‹ë˜ê±°ë‚˜ ë¡¤ë°±ëœë‹¤. ì ìš©ê°€ëŠ¥í•œ ê²½ìš° ì»¤ë°‹ ë™ì‘ì€ ë˜í•œ <code>TwoPhaseTransaction.prepare()</code> ë¥¼ í˜¸ì¶œí•œë‹¤. </p>
<p>íŠ¸ëœì­ì…˜ ìƒíƒœê°€ ë¡¤ë°±ì´ë‚˜ ì»¤ë°‹ì´í›„ì— <code>Session</code> ì€ ëª¨ë“  <code>Transaction</code> ê³¼ <code>Connection</code> ë¦¬ì†ŒìŠ¤ë¥¼ í•´ì œ í•˜ê³  SQL ë¬¸ì„ ë‚´ë³´ë‚´ëŠ” ìƒˆë¡œìš´ ìš”ì²­ ë“¤ì–´ì˜¤ë©´ ìƒˆë¡œìš´ <code>Connection</code> ê³¼ <code>Transaction</code> ê°ì²´ë¥¼ í˜¸ì¶œí•˜ëŠ” "begin" ìƒíƒœë¡œ ëŒì•„ê°„ë‹¤. </p>
<pre><code class="language-python">engine = create_engine(&quot;...&quot;)
Session = sessionmaker(bind=engine)

## new session.   no connections are in use.
session = Session()
try:
    # first query.  a Connection is acquired
    # from the Engine, and a Transaction
    # started.
    item1 = session.query(Item).get(1)

    # second query.  the same Connection/Transaction
    # are used.
    item2 = session.query(Item).get(2)

    # pending changes are created.
    item1.foo = 'bar'
    item2.bar = 'foo'

    # commit.  The pending changes above
    # are flushed via flush(), the Transaction
    # is committed, the Connection object closed
    # and discarded, the underlying DBAPI connection
    # returned to the connection pool.
    session.commit()
except:
    # on rollback, the same closure of state
    # as that of commit proceeds.
    session.rollback()
    raise
finally:
    # close the Session.  This will expunge any remaining
    # objects as well as reset any existing SessionTransaction
    # state.  Neither of these steps are usually essential.
    # However, if the commit() or rollback() itself experienced
    # an unanticipated internal failure (such as due to a mis-behaved
    # user-defined event handler), .close() will ensure that
    # invalid state is removed.
    session.close()
</code></pre>
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/orm/session_transaction.html#using-savepoint">Using SAVEPOINT</a></li>
</ul>
<p>SAVEPOINT íŠ¸ëœì­ì…˜ì€ ê¸°ë°˜ ì—”ì§„ì—ì„œ ì§€ì›í•˜ëŠ” ê²½ìš°, <code>begin_nested()</code> ë¥¼ ì´ìš©í•´ì„œ ë²”ìœ„ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤:</p>
<pre><code class="language-python">Session = sessionmaker()
session = Session()
session.add(u1)
session.add(u2)

session.begin_nested()  # establish a savepoint
session.add(u3)
session.rollback()  # rolls back u3, keeps u1 and u2

session.commit()  # commits u1 and u2
</code></pre>
<p><code>begin_nested()</code> ëŠ” ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë˜ëŠ”ë° í˜¸ì¶œë ë•Œë§ˆë‹¤ unique identifier ì™€ í•¨ê»˜ ìƒˆë¡œìš´ SAVEPOINT ê°€ ë°œí–‰ëœë‹¤. ê°ê°ì˜ <code>begin_nested()</code> ì˜ í˜¸ì¶œì— ìƒì‘í•˜ëŠ” <code>rollback()</code>, <code>commit()</code> ì´ ì‹¤í–‰ë˜ì–´ì–´ì•¼ í•œë‹¤. (ê·¸ëŸ°ë° ì£¼ì˜í• ê²Œ, ë§Œì•½ context manager(with ë¬¸ ê°™ì€) ì•ˆì— return value ê°€ ì‚¬ìš©ëœë‹¤ë©´, ë¡¤ë°±/ì»¤ë°‹ì´ context amanger ì— ì˜í•´ì„œ context ë¥¼ ë²—ì–´ë‚ ë•Œ ì‹¤í–‰ë˜ê³  return value ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì¶”ê°€í•´ì„œëŠ” ì•ˆëœë‹¤.)</p>
<p><code>begin_nested()</code>  ê°€ í˜¸ì¶œë ë•Œ, <code>flush()</code> ëŠ”  <code>autoflush</code> ì„¤ì •ê³¼ ìƒê´€ì—†ì´ ë¬´ì¡°ê±´ ì‹¤í–‰ëœë‹¤. <code>rollback()</code> ì´ ë°œìƒí•˜ë©´, <code>Session</code> ì˜ ì „ì²´ ìƒíƒœê°€ ë§Œë£Œë˜ì–´ ëª¨ë“  ì—°ì†ëœ ì†ì„±/ ê°ì²´ì— ëŒ€í•œ ì ‘ê·¼ì´ <code>begin_nested()</code> í˜¸ì¶œ ì´ì „ì˜ ì„¸ì…˜ì˜ ì „ì²´ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ê²Œ ëœë‹¤. </p>
<p><code>begin_nested()</code> ëŠ” ì ê²Œ ì‚¬ìš©ë˜ëŠ” <code>begin()</code> ë©”ì†Œë“œì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ <code>SesssionTransaction</code> ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ì´ ê°ì²´ëŠ” context manager ë¡œ ë™ì‘í•œë‹¤.  ì´ê²ƒì€ ê°œë³„ ë ˆì½”ë“œ ì‚½ì…ì—ì„œ unique constraint exception ê°™ì€ ê²ƒì„ ì¡ì„ë•Œ ê°„ê²°í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. </p>
<pre><code class="language-python">for record in records:
    try:
        with session.begin_nested():
            session.merge(record)
    except:
        print(&quot;Skipped record %s&quot; % record)
session.commit()
</code></pre>
<ul>
<li><a href="http://docs.sqlalchemy.org/en/latest/orm/session_transaction.html#autocommit-mode">Autocommit Mode</a></li>
</ul>
<p><code>Session</code> ì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>autocommit=False</code> ë¡œ ë™ì‘í•œë‹¤. ì´ ëª¨ë“œì—ì„œ <code>Session</code> ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ì´ ë˜ìë§ˆì <strong>ìë™ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤.</strong> ê·¸ë¦¬ê³ ë‚˜ì„œ íŠ¸ëœì­ì…˜ì€ <code>Session.commit()</code> , <code>Sesseion.rollback()</code> ê°€ í˜¸ì¶œë ë•Œê¹Œì§€ ëŒ€ê¸°í•œë‹¤. </p>
<p><code>Sesssion</code> ì—ëŠ” ë˜í•œ <strong>autocommit mode</strong> ë¼ëŠ” êµ¬í˜• ë ˆê±°ì‹œëª¨ë“œê°€ ìˆëŠ”ë° ì´ ëª¨ë“œëŠ” <code>**Session.begin()</code> ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ì•”ë¬µì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.** <code>Session</code> ì€ ìˆ˜í–‰í• ê²ƒì´ë‹¤. ê°ê°ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë™ì‘ì€ connection pool ì—ì„œ ì²´í¬ì•„ì›ƒëœ ìƒˆë¡œìš´ ì—°ê²°ìƒì—ì„œ ìˆ˜í–‰ë˜ê³ , ë™ì‘ì´ ì™„ë£Œë˜ëŠ” ì¦‰ì‹œ connection pool ë¡œ ë°˜í™˜ëœë‹¤.  ì´ê²ƒì€ <code>Session.query ()</code> ì—ì„œ ë°˜í™˜ ëœ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œë¿ë§Œ ì•„ë‹ˆë¼ <code>Session.execute()</code>ì™€ ê°™ì€ ë©”ì„œë“œì—ë„ í•´ë‹¹í•œë‹¤. flush ë™ì‘ì— ëŒ€í•´ì„œ <code>Session</code> ì€ flush ì§€ì†ê¸°ê°„ ë™ì•ˆ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³  ì™„ë£Œê°€ ë˜ì—ˆì„ë•Œ ì»¤ë°‹ì„ í•œë‹¤. </p>
<pre><code>- WARNING
</code></pre>
<p>"autocommit" ëª¨ë“œëŠ” ë ˆê±°ì‹œ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒìœ¼ë¡œ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê³ ë ¤í•´ì„œëŠ” ì•ˆëœë‹¤. ë§Œì•½ autocommit ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì ì–´ë„  ìˆœìˆ˜  autocommit mode ì—ì„œëŠ” sessionì„ ì‚¬ìš©í•˜ëŠ”ê²ƒ ë³´ë‹¤ <code>Sesssion.begin()</code> ë©”ì†Œë“œë¥¼ í†µí•´ì„œ íŠ¸ëœì­ì…˜ ë²”ìœ„ë¥¼ ë³´ì¥í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ì¶”ì²œí•œë‹¤. </p>
<p>ë§Œì•½ <code>Session.begin()</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ë™ì‘ì€ ì¦‰ì‹œìë™ì»¤ë°‹ê³¼ í•¨ê»˜ ad-hoc ì—°ê²°ì„ ì´ìš©í•´ì„œ ì§„í–‰í• ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì•„ë§ˆ <code>autoflush=False, expire_on_commit=False</code> ì„ ì„¤ì •í•´ì•¼í•œë‹¤. ì™œëƒí•˜ë©´ ì´ ê¸°ëŠ¥ë“¤ì€ ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ì˜ ì»¨í…ìŠ¤íŠ¸ ë‚´ì—ì„œë§Œ ì˜¤ì§€ ì‚¬ìš©ë˜ë„ë¡ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì´ë‹¤. í˜„ëŒ€ì˜ "autocommit mode" ì˜ ì‚¬ìš©ì€ í”„ë ˆì„ì›Œí¬ì™€ ê²°í•©í•˜ë ¤ëŠ” ê²½í–¥ì´ ìˆëŠ”ë° ì´ í”„ë ˆì„ì›Œí¬ëŠ” "begin" ìƒíƒœê°€ ë°œìƒí• ë•Œ ì œì–´í•˜ê¸°ë¥¼ ì›í•œë‹¤. <code>autocommit=True</code> ë¡œ ì„¤ì •ëœ session ì€ <code>Session.begin()</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ "begin" ìƒíƒœì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤. íŠ¸ëœì­ì…˜ì˜ ì‹¸ì´í´ì´ <code>Session.commit()</code>, <code>Session.rollback()</code> ì„ í•˜ìë§ˆì ì™„ì„±ëœ ì´í›„ì—, connection ê³¼ transaction ë¦¬ì†ŒìŠ¤ëŠ” í•´ì œë˜ê³  <code>Session</code> ì€ <code>Session.begin()</code> ì´ ë‹¤ì‹œ í˜¸ì¶œë  ë•Œê¹Œì§€  "autocommit" ëª¨ë“œë¡œ ëŒì•„ê°„ë‹¤. </p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=True)
session = Session()
session.begin()
try:
    item1 = session.query(Item).get(1)
    item2 = session.query(Item).get(2)
    item1.foo = 'bar'
    item2.bar = 'foo'
    session.commit()
except:
    session.rollback()
    raise
</code></pre>
<p><code>Session.begin()</code> ë©”ì†Œë“œëŠ” íŠ¸ëœì­ì…˜ í† í°ì„ ë°˜í™˜í•˜ëŠ”ë°, ì´ê²ƒì€ <code>with</code> ë¬¸ê³¼ í˜¸í™˜ì´ ëœë‹¤. </p>
<pre><code class="language-python">Session = sessionmaker(bind=engine, autocommit=True)
session = Session()
with session.begin():
    item1 = session.query(Item).get(1)
    item2 = session.query(Item).get(2)
    item1.foo = 'bar'
    item2.bar = 'foo'
</code></pre>
<pre><code>- [Using Sustransaqctions with Autocommit](http://docs.sqlalchemy.org/en/latest/orm/session_transaction.html#using-subtransactions-with-autocommit)
</code></pre>
<p>ì„œë¸ŒíŠ¸ëœì­ì…˜ì€ <code>Session.begin()</code> ë©”ì†Œë“œì˜ <code>subtransactions=True</code> í”Œë˜ê·¸ ì‚¬ìš©ê³¼ ì—°ê´€ì´ ìˆë‹¤. ì´ê²ƒì€  <code>begin ()</code> ë° <code>commit ()</code> í˜¸ì¶œì˜ ì¤‘ì²©ì„ í—ˆìš©í•˜ëŠ” ë¹„íŠ¸ëœì­ì…˜(non-transactional), êµ¬ë¶„ êµ¬ì¡°ë¥¼ ìƒì„±í•œë‹¤. ì„œë¸ŒíŠ¸ëœì­ì…˜ì˜ ëª©ì ì€ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œ ì™¸ë¶€ ì½”ë“œì™€ íŠ¸ëœì­ì…˜ì„ ì´ë¯¸ êµ¬ë¶„ í•œ ë¸”ë¡ ë‚´ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‘ë™ í•  ìˆ˜ìˆëŠ” ì½”ë“œë¥¼ êµ¬ì„± í•  ìˆ˜ìˆê²Œí•˜ëŠ” ê²ƒì´ë‹¤.(?)</p>
<p><code>substrancactions=True</code> ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì˜¤ì§ autocommit ê³¼ ì—°ê´€ì´ ìˆëŠ” ê²½ìš°ì— ìœ ìš©í•œë° ì´ê²ƒì€ ì¤‘ì²©íŠ¸ëœì­ì…˜ë¸”ë¡(Nesting of Transaction Blocks) íŒ¨í„´ê³¼ ë™ì¼í•˜ë‹¤. </p>
<pre><code class="language-python">
## method_a starts a transaction and calls method_b
def method_a(session):
    session.begin(subtransactions=True)
    try:
        method_b(session)
        session.commit()  # transaction is committed here
    except:
        session.rollback()  # rolls back the transaction
        raise


## method_b also starts a transaction, but when
## called from method_a participates in the ongoing
## transaction.
def method_b(session):
    session.begin(subtransactions=True)
    try:
        session.add(SomeObject('bat', 'lala'))
        session.commit()  # transaction is not committed yet
    except:
        session.rollback()  # rolls back the transaction, in this case
        # the one that was initiated in method_a().
        raise


## create a Session and call method_a
session = Session(autocommit=True)
method_a(session)
session.close()
</code></pre>
<p><code>Session.flush()</code> ì— ì˜í•´ì„œ ì‚¬ìš©ë˜ëŠ” ì„œë¸ŒíŠ¸ëœì­ì…˜ë“¤ì€ autocommit ì— ê´€ê³„ì—†ì´ íŠ¸ëœì­ì…˜ë‚´ì—ì„œ ë°œìƒí•˜ëŠ” flush ë™ì‘ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ì„œ ì²˜ë¦¬í•œë‹¤. autocommit ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°, ìµœì¢… ì‚¬ìš©ìê°€ ì—¬ì „íˆ íŠ¸ëœì­ì…˜ì˜ "scope"ë¥¼ ìœ ì§€í•˜ëŠ” ì¤‘ê°„ ì‘ì—…ì—ì„œ ì‹¤íŒ¨í•œ flush ë¥¼ ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ <code>Session</code>ì„ "pending rollback"ìƒíƒœë¡œ ë§Œë“ ë‹¤. </p>
<hr />
<p>ë‹¤ì‹œ í˜„ì¬ ê²ªê³ ìˆëŠ” ì˜ë¬¸ë“¤ì„ ì •ë¦¬í•´ë³´ë©´ ì´ë ‡ë‹¤. </p>
<ul>
<li><strong>autocommit = True || False ì¸ ìƒíƒœì—ì„œ, commit() ì„ í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ê°€ ì™œ ì•ˆë“¤ì–´ê°ˆê¹Œ?</strong></li>
</ul>
<p>â‡’ ê²°êµ­ <code>commit()</code> í•¨ìˆ˜ì™€ autocommit ì„¤ì • ì‚¬ì´ì— ì—°ê´€ì´ ìˆëŠëƒê°€ í•µì‹¬ì¸ë° autocommit ì´ë¼ëŠ” ì´ë¦„ì´ ê°€ì§€ëŠ” ì˜ë¯¸ì™€ ë‹¤ë¥´ê²Œ <code>commit()</code> í•¨ìˆ˜ì˜ ìë™í˜¸ì¶œ ìœ ë¬´ì™€ëŠ” ê´€ê³„ê°€ ì—†ë‹¤. autocommit ì€ ìœ„ì— ìë£Œì—ì„œë„ ë‚˜ì™€ìˆëŠ”ê²ƒ ì²˜ëŸ¼  <code>autocommit=False</code> ë¡œ ì„¤ì •í•˜ë©´ <code>Session</code> ì€ ìë™ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤. <code>autocommit=True</code> ëª¨ë“œì—ì„œëŠ” <code>session.begin()</code> ì„ ëª…ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ íŠ¸ëœì­ì…˜ì´ ì‹œì‘ëœë‹¤. autocommit ì˜ ì‚¬ìš©ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë°ì´í„° ë³€ê²½ì‘ì—…ì˜ ë°˜ì˜ì„ ìœ„í•´ì„œëŠ” <code>commit()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤. </p>
<ul>
<li><strong>autocommit = False ì¸ ìƒíƒœì—ì„œ, begin() ì„ í•˜ë©´ ì—ëŸ¬ ë°œìƒ?</strong></li>
</ul>
<p>â‡’ ì—ëŸ¬ë©”ì‹œì§€ê°€ A transaction is already begun. ë¼ê³  ë‚˜ì˜¨ë‹¤.  ì•ì—ì„œë„ ë§í–ˆë“¯ì´ <strong>autocommit ì„¤ì •ì€ íŠ¸ëœì­ì…˜ì˜ ìë™ì‹œì‘ì—¬ë¶€ì™€ ê´€ê³„ê°€ ìˆë‹¤.</strong>  <code>autocommit=False</code> ì´ë©´ ìë™ìœ¼ë¡œ ì‹œì‘í•œë‹¤. ë•Œë¬¸ì— <code>begin()</code> ì„ ì“°ê²Œ ë˜ë©´ ì¤‘ë³µìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê²Œ ë˜ëŠ” ì…ˆì´ë¼ì„œ ìœ„ì™€ê°™ì€ ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ë±‰ëŠ”ë‹¤.</p>
<p>ì‹¤ì œë¡œ SQLAlchemy ì˜ <a href="https://github.com/zzzeek/sqlalchemy/blob/master/lib/sqlalchemy/orm/session.py#L776">Session Class</a> ì— <code>__init__()</code> ë¶€ë¶„ì— ì•„ë˜ì™€ ê°™ì´ autocommit ì´ False ì¸ ê²½ìš°, <code>begin()</code> í•¨ìˆ˜ë¥¼ ìë™ì ìœ¼ë¡œ í˜¸ì¶œí•˜ê³  ìˆë‹¤. </p>
<pre><code class="language-python">  if not self.autocommit:
      self.begin()
</code></pre>
<p>ê½¤ ì˜¤ë«ë™ì•ˆ ê°€ì§€ê³  ìˆì—ˆë˜ ì˜ë¬¸ì´ í’€ë ¸ë‹¤. ë‚˜ì˜ ì´ëŸ° ì˜ë¬¸ì€ autocommit ì´ë¼ëŠ” ì„¤ì • ì´ë¦„ì´ ê°€ì§€ëŠ” ì˜ë¯¸ ë•Œë¬¸ì— í˜¼ëˆì„ ê°€ì§„ê²Œ ì•„ë‹Œê°€ ì‹¶ë‹¤. ì»¤ë°‹ì„ ìë™ìœ¼ë¡œ í•´ì£¼ëŠëƒê°€ ì•„ë‹ˆë¼, ìë™ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ëŠëƒê°€ í•µì‹¬ì¸ê²ƒ ê°™ë‹¤. ì¢€ ë” ë‚˜ì€ ë„¤ì´ë°ì´ì—ˆìœ¼ë©´ ì¢‹ì•˜ì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤. (auto_begin_transaction ê°™ì€..) </p>
<p><strong>Reference</strong> </p>
<ul>
<li><a href="https://zetawiki.com/wiki/MySQL_AUTOCOMMIT_%EC%84%A4%EC%A0%95">https://zetawiki.com/wiki/MySQL_AUTOCOMMIT_ì„¤ì •</a></li>
<li>http://bryan7.tistory.com/78</li>
</ul>
    </div>
    <div>
        
            <a href="/tags/Python.html" style="text-decoration: none; color: #666; margin-right: 0.5rem;">#Python</a>
        
            <a href="/tags/sqlalchemy.html" style="text-decoration: none; color: #666; margin-right: 0.5rem;">#sqlalchemy</a>
        
            <a href="/tags/autocommit.html" style="text-decoration: none; color: #666; margin-right: 0.5rem;">#autocommit</a>
        
    </div> 
    <footer>
    <div style="text-align: center;">
        Copyright Â© <script>document.write(new Date().getFullYear());</script> ash84.io All rights reserved.
    </div>
</footer>
</div>
</body>
</html>